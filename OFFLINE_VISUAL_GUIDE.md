# Driver Forms Offline Mode - Quick Visual Guide

## Status Indicators

### Online Mode
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸŸ¢ Online  [Load Data] [Check Network]    â”‚
â”‚             [Sync Pending (0)] [+ Create]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Offline Mode with Cached Data
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸŸ  Offline  ðŸ“¦ Cached: 25 drivers, 15 materials, 10 suppliers         â”‚
â”‚              [Load Data (disabled)] [Check Network]                     â”‚
â”‚              [Sync Pending (0) (disabled)] [+ Create]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Offline Mode with Pending Forms
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸŸ  Offline  ðŸ“¦ Cached: 25 drivers, 15 materials, 10 suppliers                 â”‚
â”‚              â³ 3 pending forms to sync                                         â”‚
â”‚              [Load Data (disabled)] [Check Network]                             â”‚
â”‚              [Sync Pending (3) (disabled)] [+ Create]                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Form Status Badges

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… Delivered      (Green badge)             â”‚
â”‚  âŒ Rejected       (Red badge)               â”‚
â”‚  âºï¸  Pending        (Yellow badge)            â”‚
â”‚  ðŸ“´ Pending Sync   (Orange badge - offline)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Form Drawer - Online vs Offline

### Online Mode
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create Driver Form                     â”‚
â”‚  ðŸŸ¢ Online  [Refresh Data]              â”‚
â”‚                                         â”‚
â”‚  Driver *           [Select driver â–¾]  â”‚
â”‚  Start Date *       [Pick date]        â”‚
â”‚  End Date *         [Pick date]        â”‚
â”‚  Tanker *           [Select tanker â–¾]  â”‚
â”‚                                         â”‚
â”‚  âœ… All dropdowns populated with live data
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Offline Mode
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create Driver Form                                     â”‚
â”‚  ðŸŸ  Offline  [Refresh Data]                             â”‚
â”‚  ðŸ“¦ Using cached data (25 drivers, 15 materials, 10     â”‚
â”‚     suppliers)                                          â”‚
â”‚                                                         â”‚
â”‚  Driver *           [Select driver â–¾]                  â”‚
â”‚  Start Date *       [Pick date]                        â”‚
â”‚  End Date *         [Pick date]                        â”‚
â”‚  Tanker *           [Select tanker â–¾] (empty - online) â”‚
â”‚                                                         â”‚
â”‚  âœ… Dropdowns populated with cached data                â”‚
â”‚  âš ï¸  Tanker dropdown empty (not cached)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## User Workflow Examples

### Scenario 1: Create Form While Online
```
1. User opens page â†’ ðŸŸ¢ Online
2. Click [+ Create Form]
3. Form drawer opens with live data
4. Fill form, click [Create Form]
5. âœ… "Driver form created successfully"
6. Form appears in list with âœ… Delivered / âºï¸ Pending badge
```

### Scenario 2: Prepare for Offline Work
```
1. User is ðŸŸ¢ Online
2. Click [Load Data] button
3. Wait for: "All data loaded and stored offline successfully!"
4. âœ… Data now cached in browser
5. User can now work offline
```

### Scenario 3: Create Form While Offline
```
1. Network disconnects â†’ ðŸŸ  Offline
2. Page shows: ðŸ“¦ Cached: X drivers, Y materials, Z suppliers
3. Click [+ Create Form]
4. Form drawer shows: ðŸŸ  Offline with cached data count
5. Fill form using cached dropdowns
6. Click [Create Form]
7. ðŸ’¾ "Driver form saved offline. It will be synced when..."
8. Form appears with ðŸ“´ Pending Sync badge
9. Counter updates: â³ 1 pending form to sync
10. [Sync Pending (1)] button shows count
```

### Scenario 4: Sync Pending Forms
```
1. Network reconnects â†’ ðŸŸ¢ Online
2. Page shows: â³ 3 pending forms to sync
3. Click [Sync Pending (3)] button
4. Processing...
5. âœ… "Successfully synced 3 form(s)"
6. Forms lose ðŸ“´ Pending Sync badge
7. Counter resets: [Sync Pending (0)]
8. Forms now have âœ… or âºï¸ badge
```

### Scenario 5: Manual Network Check
```
1. User unsure of connection status
2. Click [Check Network] button
3a. If online: âœ… "Network connection is active"
3b. If offline: âŒ "No network connection detected"
4. Badge updates to reflect true status
```

### Scenario 6: Work Offline, Refresh Page
```
1. User is ðŸŸ  Offline
2. Creates 2 forms offline
3. Counter shows: â³ 2 pending forms to sync
4. User refreshes page (F5)
5. Page reloads â†’ ðŸŸ  Offline
6. Still shows: â³ 2 pending forms to sync
7. âœ… Data persisted in localStorage
8. Forms still show ðŸ“´ Pending Sync badge
```

## Button States

### Online Mode Buttons
```
[Load Data]          âœ… Enabled - loads fresh data
[Check Network]      âœ… Enabled - verifies connection  
[Sync Pending (X)]   âœ… Enabled if X > 0
[+ Create Form]      âœ… Enabled - uses live data
[Refresh Data]       âœ… Enabled - fetches from API
```

### Offline Mode Buttons
```
[Load Data]          âŒ Disabled - needs network
[Check Network]      âœ… Enabled - verifies connection
[Sync Pending (X)]   âŒ Disabled - needs network
[+ Create Form]      âœ… Enabled - uses cached data
[Refresh Data]       âœ… Enabled - reloads from localStorage
```

## Toast Notifications

```
Online Actions:
âœ… "All data loaded and stored offline successfully!"
âœ… "Driver form created successfully"
âœ… "Successfully synced 3 form(s)"
âœ… "Network connection is active"

Offline Actions:
ðŸ’¾ "Driver form saved offline. It will be synced when you're back online."
âŒ "No network connection detected"
âŒ "You must be online to sync pending forms"
âŒ "You need to be online to load data"

Mixed Results:
âš ï¸ "Synced 2 form(s), 1 failed"
â„¹ï¸ "No pending forms to sync"
```

## Debugging Checklist

### If offline data not loading:
```
â˜‘ï¸ Check browser console for errors
â˜‘ï¸ Open DevTools > Application > Local Storage
â˜‘ï¸ Verify offline_* keys exist
â˜‘ï¸ Run test-offline-data.js in console
â˜‘ï¸ Click [Load Data] while online first
â˜‘ï¸ Click [Refresh Data] to manually reload
â˜‘ï¸ Check network badge matches actual connectivity
```

### If forms not syncing:
```
â˜‘ï¸ Verify actually online (green badge)
â˜‘ï¸ Click [Check Network] to confirm
â˜‘ï¸ Check console for sync errors
â˜‘ï¸ Verify pending count > 0
â˜‘ï¸ Check localStorage for pending forms
â˜‘ï¸ Try [Refresh Data] then sync again
```

### If badge shows wrong status:
```
â˜‘ï¸ Click [Check Network] button
â˜‘ï¸ Wait 30 seconds for auto-check
â˜‘ï¸ Toggle airplane mode off/on
â˜‘ï¸ Check browser console for network logs
â˜‘ï¸ Verify /api/health-check is accessible
```

## Data Flow Diagram

```
User Action â†’ Network Check â†’ Data Source Selection â†’ Display
     â”‚              â”‚                    â”‚                â”‚
     â”‚              â”œâ”€ Online â”€â”€â”€â”€â”€â”€> API/Supabase       â”‚
     â”‚              â”‚                    â”‚                â”‚
     â”‚              â””â”€ Offline â”€â”€â”€â”€â”€> localStorage â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â””â”€ Submit Form â”€â”¬â”€ Online â”€â”€> POST to API â”€â”€> Success
                     â”‚
                     â””â”€ Offline â”€> Save to localStorage
                                   â””â”€> Pending badge
                                   â””â”€> Counter++
                                   â””â”€> Wait for sync
```

## Color Coding

- ðŸŸ¢ **Green**: Online, connected, success, delivered
- ðŸŸ  **Orange**: Offline, pending sync, warning
- ðŸ”´ **Red**: Error, rejected, failed
- ðŸŸ¡ **Yellow**: Pending action/status
- âš« **Gray**: Disabled, neutral

## Key Performance Indicators

```
Network Check Interval:  30 seconds (automatic)
Health Check Timeout:    5 seconds
Data Refresh:            On-demand (manual button)
Auto-Sync:               Disabled (manual only)
Cache Expiry:            None (persists until cleared)
Sync Strategy:           One-by-one (sequential)
```
